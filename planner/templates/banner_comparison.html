{% extends "base.html" %}
{% block extrahead %}
{% endblock %}
{% block content %}
{% load static %}
<style>
* {outline}
</style>

<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>
<script type='text/javascript'>
	var json_data = {{ json_data|safe }};
</script>

<div id="app">
	<v-app>

		[[message]]
		
		<template>
				<div>
						<v-toolbar flat color="white">
						  <v-toolbar-title>Expandable Table</v-toolbar-title>
						  <v-spacer></v-spacer>
						  <v-btn color="primary" dark @click="expand = !expand">
							[[ expand ? 'Close' : 'Keep' ]] other rows
						  </v-btn>
						</v-toolbar>
			<v-data-table
			:headers="headers"
			:items="desserts"
			:expand="expand"
			item-key="name"
			class="elevation-1"
			>
			<template v-slot:items="props">
				<tr @click="props.expanded = !props.expanded">
				<td>[[props.item.name]]  </td>
				<td class="text-xs-right">[[props.item.calories]]</td>
				<td class="text-xs-right">[[props.item.fat]] </td>
				<td class="text-xs-right">[[props.item.carbs]] </td>
				<td class="text-xs-right">[[props.item.protein]]  </td>
				<td class="text-xs-right">[[props.item.iron]] </td>
			</template>
			<template v-slot:expand="props">
					<v-card flat>
					  <v-card-text>Peek-a-boo!</v-card-text>
					</v-card>
				  </template>
			</v-data-table>
			</div>
		</template>
	</v-app>
</div>

<script>
    var app = new Vue({
      delimiters: ['[[', ']]'],
      el: '#app',
      data: {
		  		expand: false,
				message: 'Hello Vue!',
				search: '',
				json_data: json_data,
				headers: [
				{
					text: 'Dessert (100g serving)',
					align: 'left',
					sortable: false,
					value: 'name'
			},
			{ text: 'Calories', value: 'calories' },
			{ text: 'Fat (g)', value: 'fat' },
			{ text: 'Carbs (g)', value: 'carbs' },
			{ text: 'Protein (g)', value: 'protein' },
			{ text: 'Iron (%)', value: 'iron' }
			],
        desserts: [
          {
            name: 'Frozen Yogurt',
            calories: 159,
            fat: 6.0,
            carbs: 24,
            protein: 4.0,
            iron: '1%'
          },
          {
            name: 'Ice cream sandwich',
            calories: 237,
            fat: 9.0,
            carbs: 37,
            protein: 4.3,
            iron: '1%'
          },
          {
            name: 'Eclair',
            calories: 262,
            fat: 16.0,
            carbs: 23,
            protein: 6.0,
            iron: '7%'
          },
          {
            name: 'Cupcake',
            calories: 305,
            fat: 3.7,
            carbs: 67,
            protein: 4.3,
            iron: '8%'
          },
          {
            name: 'Gingerbread',
            calories: 356,
            fat: 16.0,
            carbs: 49,
            protein: 3.9,
            iron: '16%'
          },
          {
            name: 'Jelly bean',
            calories: 375,
            fat: 0.0,
            carbs: 94,
            protein: 0.0,
            iron: '0%'
          },
          {
            name: 'Lollipop',
            calories: 392,
            fat: 0.2,
            carbs: 98,
            protein: 0,
            iron: '2%'
          },
          {
            name: 'Honeycomb',
            calories: 408,
            fat: 3.2,
            carbs: 87,
            protein: 6.5,
            iron: '45%'
          },
          {
            name: 'Donut',
            calories: 452,
            fat: 25.0,
            carbs: 51,
            protein: 4.9,
            iron: '22%'
          },
          {
            name: 'KitKat',
            calories: 518,
            fat: 26.0,
            carbs: 65,
            protein: 7,
            iron: '6%'
          }
        ]

      },
      methods: {
          greet: function(name) {
              console.log('Hello from ' + name + '!');
			  console.log('course data: ', this.courseData);
          },
		  // https://stackoverflow.com/questions/44309464/hide-table-column-with-vue-js
		  showColumn(col){
			return this.headers.find(h => h.value === col).selected
		  },
		  toggle(col) {
			let tempSelected = this.headers.find(h => h.value === col).selected;
			this.headers.find(h => h.value === col).selected = !tempSelected;
		  },
      },
	  // https://stackoverflow.com/questions/44309464/hide-table-column-with-vue-js
	  computed:{
  		filteredHeaders(){
    		return this.headers.filter(h => h.selected)
		},
		checkboxVal(col) {
			return this.headers.find(h => h.value === col).selected;
		}
	  },
	  mounted: function(){
		  console.log('mounted!');
		  $.ajax({                       // initialize an AJAX request
				type: "GET",
				url: "/planner/ajax/fetch-banner-comparison-data/",                    // set the url of the request
				dataType: 'json',
				data: {
					'departmentId': json_data.departmentId       // add the faculty id to the POST parameters
				},
				success: function (data) {   // `data` is the return of the `load_courses` view function
					console.log(data);
					console.log('success!');
					//if (!data.success) {
					//	document.getElementById('error-message-container').style.display = 'block';
					//console.log('got here');
					//document.getElementById('message-about-errors').style.display = 'none';
					//	$("#error-message").html(data.message);
					//} else {
					//	window.location=redirectUrl;
					//}
				}
			});
	  }
    });
</script>


<script>
		//https://simpleisbetterthancomplex.com/tutorial/2018/01/29/how-to-implement-dependent-or-chained-dropdown-list-with-django.html
		//https://simpleisbetterthancomplex.com/tutorial/2016/08/29/how-to-work-with-ajax-request-with-django.html
		function addFacultyToViewList(facultyId) {
			var url = $("#facultyTable").attr("add-faculty-url");  // get the url of the view
			var redirectUrl = $("#facultyTable").attr("redirect-url");
			// https://stackoverflow.com/questions/13465711/how-do-i-post-with-jquery-ajax-in-django
			$.ajax({                       // initialize an AJAX request
				type: "POST",
				url: url,                    // set the url of the request
				dataType: 'json',
				data: {
					'facultyId': facultyId       // add the faculty id to the POST parameters
				},
				success: function (data) {   // `data` is the return of the `load_courses` view function
					console.log(data);
					console.log('success!');
					if (!data.success) {
						document.getElementById('error-message-container').style.display = 'block';
					//console.log('got here');
					//document.getElementById('message-about-errors').style.display = 'none';
						$("#error-message").html(data.message);
					} else {
						window.location=redirectUrl;
					}
				}
			});
			
		};
		
	</script>
	





<!-- https://stackoverflow.com/questions/49421170/change-font-size-of-v-radio-vuetify?rq=1 -->
<style scoped>
	.v-label {
    	font-size: 14px;
		margin-left: 2px;
	}
  	.v-input input {
		height: 32px;
		margin-bottom: 4px;
	}
</style>




<script>    
	//window.addEventListener("resize",function(){alertMessage();},true);
	$(window).load(function(){
	$("#nav-bannercomparison").addClass("current");
	$('.page-name').find('h1').replaceWith('<h1>Banner Comparison</h1><h2>{{department}}, {{academic_year_string}}</h2>');
	$(".page-name").stop().animate({opacity: 1,'margin-left': '5%'}, 700);});
</script>


{% endblock %}